
# Кастомный аудиоплеер для студентов

## Проблема

Студентка Юлия Соваськова сообщает о двух проблемах с аудио в курсе "Бухгалтерия как бизнес":

1. При паузе или блокировке телефона аудио сбрасывается на начало
2. Ползунок стандартного плеера слишком маленький на мобильном

Сейчас в студенческом виде (`AudioBlock`, строки 147-156) используется стандартный браузерный `<audio controls>`, который не сохраняет позицию и имеет мелкие элементы управления на мобильных.

## Решение

Создать кастомный компонент `CustomAudioPlayer` с:
- Крупным ползунком прогресса (высота 12px вместо стандартных 4px, увеличенная зона касания)
- Сохранением позиции воспроизведения в `localStorage` (ключ = URL аудио)
- Восстановлением позиции при возврате на страницу или после блокировки телефона
- Кнопкой play/pause, отображением текущего времени и длительности
- Скоростью воспроизведения (1x, 1.25x, 1.5x, 2x)

### Логика сохранения позиции

- Каждые 2 секунды при воспроизведении записывать `currentTime` в `localStorage`
- Ключ: `audio-pos-{md5(url)}` (или просто хэш URL)
- При монтировании компонента -- восстановить позицию из `localStorage`
- При достижении конца трека -- удалить запись из `localStorage`

## Затронутые файлы

| Файл | Действие |
|---|---|
| `src/components/ui/CustomAudioPlayer.tsx` | Новый компонент -- кастомный аудиоплеер |
| `src/components/admin/lesson-editor/blocks/AudioBlock.tsx` | Заменить `<audio controls>` в студенческом виде (строки 147-156) на `<CustomAudioPlayer>` |

## Техническая реализация

### Новый файл: `src/components/ui/CustomAudioPlayer.tsx`

Компонент принимает `src: string` и рендерит:
- Скрытый `<audio>` элемент (ref)
- Кнопка Play/Pause (крупная, 44x44px -- удобно для касания)
- Slider прогресса (используем существующий `@radix-ui/react-slider` из проекта, увеличенный стилями)
- Текст времени: `01:23 / 05:47`
- Кнопка скорости: `1x` -> `1.25x` -> `1.5x` -> `2x`
- Сохранение/восстановление позиции через `localStorage`

### Изменение в `AudioBlock.tsx` (студенческий вид)

```tsx
// Было (строки 147-156):
<audio controls controlsList="nodownload" ...>
  <source src={content.url} />
</audio>

// Станет:
<CustomAudioPlayer src={content.url} onError={() => setAudioError(true)} />
```

Редакторский превью-плеер (строки 268-274) остаётся без изменений -- там стандартный `<audio>` достаточен.

## Что НЕ трогаем

- Редакторский вид AudioBlock (превью в админке) -- без изменений
- Компонент `Slider` (`src/components/ui/slider.tsx`) -- без изменений, используем as-is
- Видеоплеер в `QuestLesson.tsx` -- без изменений
- VoiceRecorder / TicketChat аудио -- без изменений
