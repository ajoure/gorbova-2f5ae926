
# Исправление: кнопка "Ссылка на оплату" недоступна при отсутствии привязанных карт

## Проблема

В `ContactDetailSheet.tsx` кнопка "Ссылка на оплату" находится внутри условного блока `paymentMethods.length > 0` (строки 1662-1681). Если у контакта нет привязанных карт (как на скриншоте — "Нет привязанных карт"), кнопка не отображается. Создание ссылки на оплату не требует наличия карты, поэтому кнопка должна быть доступна всегда.

## Решение

Вынести кнопку "Ссылка на оплату" из блока привязанных карт и разместить её после блока карт, но внутри того же Card-компонента — так она будет видна независимо от наличия карт.

## Файл

| Файл | Изменение |
|---|---|
| `src/components/admin/ContactDetailSheet.tsx` | Перенести кнопку "Ссылка на оплату" (и "Списать деньги") за пределы условия `paymentMethods.length > 0`, но оставить внутри `CardContent`. Кнопки отображаются для `isSuperAdmin()` всегда, когда есть `contact.user_id`. |

## Детали реализации

Текущая структура (упрощённо):
```
CardContent
  if loading -> spinner
  else if paymentMethods.length > 0
    -> карточки карт
    -> if isSuperAdmin: [Списать деньги] [Ссылка на оплату]   <-- скрыто если карт нет
  else
    -> "Нет привязанных карт"
```

Новая структура:
```
CardContent
  if loading -> spinner
  else if paymentMethods.length > 0
    -> карточки карт
  else
    -> "Нет привязанных карт"

  // Кнопки вынесены из условия карт
  if isSuperAdmin:
    [Списать деньги] [Ссылка на оплату]
```

Кнопка "Списать деньги" тоже выносится, так как она логически связана с действиями администратора, а не с наличием карт (хотя при отсутствии карт списание невозможно — но это уже валидация на уровне диалога).

## Что НЕ меняется

- Логика `AdminPaymentLinkDialog` и `AdminChargeDialog` — без изменений
- Edge-функция `admin-create-payment-link` — без изменений
- Остальные секции карточки контакта — без изменений
- RLS-политики — без изменений
