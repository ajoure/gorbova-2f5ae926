

# –ü–ª–∞–Ω: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ published_at + –¥—É–±–ª–∏–∫–∞—Ç—ã –º–æ–¥—É–ª–µ–π

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (BLOCKER)

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –£—Ä–æ–∫ –≤–∏–¥–µ–Ω –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ `published_at` –≤ –±—É–¥—É—â–µ–º

**–ü—Ä–∏—á–∏–Ω–∞:**  
–í `useTrainingLessons.tsx` **–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∏–ª—å—Ç—Ä –ø–æ `is_active`**.  
- –£—Ä–æ–∫ –≤ –ë–î: `is_active = false`, `published_at = 2026-02-05 17:00:00+00`
- –•—É–∫ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï —É—Ä–æ–∫–∏ –º–æ–¥—É–ª—è –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `is_active`
- –§–∏–ª—å—Ç—Ä `published_at` –µ—Å—Ç—å (—Å—Ç—Ä–æ–∫–∏ 121-128), –Ω–æ –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω –µ—Å–ª–∏ —É—Ä–æ–∫ —Å `is_active = false` –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Å–ø–∏—Å–æ–∫

**SQL-–ø—Ä—É—Ñ:**
```sql
-- –£—Ä–æ–∫ is_active = false, –Ω–æ –≤–∏–¥–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
SELECT is_active, published_at, title 
FROM training_lessons 
WHERE module_id = (
  SELECT id FROM training_modules WHERE slug = 'buhgalteriya-kak-biznes'
);
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: is_active = false, published_at = 2026-02-05 17:00+00
```

**–§–∞–π–ª:** `src/hooks/useTrainingLessons.tsx`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (PATCH-1):**  
–î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä `.eq("is_active", true)` –≤ –∑–∞–ø—Ä–æ—Å (—Å—Ç—Ä–æ–∫–∞ 84):

```typescript
// –°—Ç—Ä–æ–∫–∞ 81-86
const { data: lessonsData, error } = await supabase
  .from("training_lessons")
  .select("*")
  .eq("module_id", moduleId)
  .eq("is_active", true)  // ‚Üê –î–û–ë–ê–í–ò–¢–¨
  .order("sort_order", { ascending: true });
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –î—É–±–ª–∏–∫–∞—Ç—ã –∫–∞—Ä—Ç–æ—á–∫–∏ "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –∫–∞–∫ –±–∏–∑–Ω–µ—Å"

**–ü—Ä–∏—á–∏–Ω–∞:**  
–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ slug –≤ —É—Å–ª–æ–≤–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

**–§–∞–π–ª:** `src/pages/Learning.tsx`

–°—Ç—Ä–æ–∫–∞ 103:
```javascript
courseSlug: "buhgalteriya-kak-biznes",
```

–°—Ç—Ä–æ–∫–∞ 408:
```javascript
if (product.courseSlug === "buh-business") {  // ‚Üê –ù–ï–í–ï–†–ù–´–ô SLUG!
```

–£—Å–ª–æ–≤–∏–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –¥–æ—Å—Ç—É–ø–µ ‚Üí –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–Ω–µ –∫—É–ø–ª–µ–Ω–æ" + –º–æ–¥—É–ª—å –∏–∑ –ë–î —Ç–æ–∂–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (PATCH-2):**  
–ó–∞–º–µ–Ω–∏—Ç—å `"buh-business"` –Ω–∞ `"buhgalteriya-kak-biznes"` (—Å—Ç—Ä–æ–∫–∞ 408):

```typescript
// –°—Ç—Ä–æ–∫–∞ 407-408
// Special handling for buh-business
if (product.courseSlug === "buhgalteriya-kak-biznes") {  // ‚Üê –ò–°–ü–†–ê–í–ò–¢–¨
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ `published_at` –≤ –∞–¥–º–∏–Ω–∫–µ

**–ü—Ä–∏—á–∏–Ω–∞:**  
`new Date("2026-02-05T18:00:00")` –ø–∞—Ä—Å–∏—Ç—Å—è –≤ **–ª–æ–∫–∞–ª—å–Ω–æ–π —Ç–∞–π–º–∑–æ–Ω–µ –±—Ä–∞—É–∑–µ—Ä–∞**, –∞ –Ω–µ –≤ Europe/Minsk.

**–§–∞–π–ª:** `src/pages/admin/AdminTrainingLessons.tsx` (—Å—Ç—Ä–æ–∫–∏ 442-446, 473-477)

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
publishedAt = formatInTimeZone(
  new Date(`${dateStr}T${publishTime}:00`),  // ‚Üê –ü–∞—Ä—Å–∏—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π TZ!
  publishTimezone, 
  "yyyy-MM-dd'T'HH:mm:ssXXX"
);
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (PATCH-3):**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `date-fns-tz/fromZonedTime` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—Ç—ã –∏–∑ "wall clock" –≤—Ä–µ–º–µ–Ω–∏:

```typescript
import { fromZonedTime } from "date-fns-tz";

// ...

// –í–º–µ—Å—Ç–æ new Date(...) + formatInTimeZone:
const wallClockDate = new Date(`${dateStr}T${publishTime}:00`);
// –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º wallClockDate –∫–∞–∫ –≤—Ä–µ–º—è –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π TZ
const utcDate = fromZonedTime(wallClockDate, publishTimezone);
publishedAt = utcDate.toISOString();
```

–ò–ª–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–∫—É —Å offset.

---

## üìã –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|------|-----------|-------------|
| `src/hooks/useTrainingLessons.tsx` | –î–æ–±–∞–≤–∏—Ç—å `.eq("is_active", true)` –≤ –∑–∞–ø—Ä–æ—Å | BLOCKER |
| `src/pages/Learning.tsx` | –ò—Å–ø—Ä–∞–≤–∏—Ç—å slug `"buh-business"` ‚Üí `"buhgalteriya-kak-biznes"` | BLOCKER |
| `src/pages/admin/AdminTrainingLessons.tsx` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `fromZonedTime` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å–±–æ—Ä–∫–∏ `published_at` | HIGH |

---

## DoD (Definition of Done)

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –ö—Ä–∏—Ç–µ—Ä–∏–π |
|----------|----------|
| –£—Ä–æ–∫ —Å `is_active = false` | –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ (–¥–∞–∂–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –¥–æ—Å—Ç—É–ø–æ–º) |
| –£—Ä–æ–∫ —Å `published_at` –≤ –±—É–¥—É—â–µ–º | –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –ü—Ä—è–º–æ–π URL future-—É—Ä–æ–∫–∞ | –ó–∞–≥–ª—É—à–∫–∞ "–£—Ä–æ–∫ –µ—â—ë –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω" —Å –¥–∞—Ç–æ–π |
| –ê–¥–º–∏–Ω | –í–∏–¥–∏—Ç –≤—Å–µ —É—Ä–æ–∫–∏ (bypass) |
| "–ú–æ—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞" | –û–¥–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –∫–∞–∫ –±–∏–∑–Ω–µ—Å" (–±–µ–∑ –¥—É–±–ª—è) |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `published_at` 18:00 Minsk | –í –ë–î: `17:00:00+00` (UTC) |

---

## –¢–µ—Å—Ç-–∫–µ–π—Å—ã

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å gerda_nat@mail.ru** (–Ω–µ –∞–¥–º–∏–Ω):
   - –û—Ç–∫—Ä—ã—Ç—å /library/buhgalteriya-kak-biznes ‚Üí —É—Ä–æ–∫ –ù–ï –≤–∏–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ
   - –ü—Ä—è–º–æ–π URL /library/buhgalteriya-kak-biznes/test-v-kakoj-roli-vy-nahodites-sejchas ‚Üí –∑–∞–≥–ª—É—à–∫–∞ "–£—Ä–æ–∫ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è 5 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≤ 18:00"

2. **–ê–¥–º–∏–Ω 7500084@gmail.com**:
   - –£—Ä–æ–∫ –≤–∏–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

3. **"–ú–æ—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞"**:
   - –û–¥–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –∫–∞–∫ –±–∏–∑–Ω–µ—Å" —Å –±–µ–π–¥–∂–µ–º "–ö—É–ø–ª–µ–Ω–æ"/"–ê–∫—Ç–∏–≤–Ω–æ"

